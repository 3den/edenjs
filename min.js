(function(e){"use strict";e.observable=function(e){var n={},t=[].slice;e.on=function(t,r){if(typeof r==="function"){t.replace(/[^\s]+/g,function(e,t){(n[e]=n[e]||[]).push(r);r.typed=t>0})}return e};e.off=function(t,r){if(t==="*")n={};else if(r){var o=n[t];for(var u=0,c;c=o&&o[u];++u){if(c===r)o.splice(u,1)}}else{t.replace(/[^\s]+/g,function(e){n[e]=[]})}return e};e.one=function(n,t){if(t)t.one=true;return e.on(n,t)};e.trigger=function(r){var o=t.call(arguments,1),u=n[r]||[];for(var c=0,i;i=u[c];++c){if(!i.busy){i.busy=true;i.apply(e,i.typed?[r].concat(o):o);if(i.one){u.splice(c,1);c--}i.busy=false}}return e};return e};e.render=function(){var e={},n={"\\":"\\\\","\n":"\\n","\r":"\\r","'":"\\'"},t={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};function r(t,r,u){if(u===true)u=o;t=t||"";return(e[t]=e[t]||new Function("_","e","return '"+t.replace(/[\\\n\r']/g,function(e){return n[e]}).replace(/{\s*([\w\.]+)\s*}/g,"' + (e?e(_.$1,'$1'):_.$1||(_.$1==null?'':_.$1)) + '")+"'"))(r,u)}function o(e,n){return e==null?"":(e+"").replace(/[&\"<>]/g,function(e){return t[e]})}return r}();e.route=function(){var n=[];function t(e,n){var u;if(typeof e==="function"){t("*",e)}else if(n){r(e,n)}else if(typeof e==="object"){for(u in e)e.hasOwnProperty(u)&&r(u,e[u])}else o(e);return t}function r(e,t){var r=["match"],o,u;o="^#?!?"+e.replace(/[\/\=\?\$\^]/g,"\\$&").replace(/\*/g,".*").replace(/\{(\w+)\}/g,function(e,n){r.push(n);return"(\\w+)"})+"$";n.push({regex:new RegExp(o),keys:r,callback:t})}function o(e){var r=n.length,o;for(o=0;o<r;o++)u(e,n[o]);t.trigger("execute",e)}function u(e,n){var t=e.match(n.regex);if(t)n.callback(c(e,n.keys,t))}function c(e,n,t){var r={path:e},o=n.length,u;for(u=0;u<o;u++)r[n[u]]=t[u];return r}t.map=n;t.clear=function(){n=[];return t};return e.observable(t)}();if(typeof window!=="undefined"){e.route.on("execute",function(e){try{history.pushState(null,null,e)}catch(n){window.location=e[0]==="#"?e:"#"+e}}).on("load",function(){this(location.pathname+location.search+location.hash)});if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){e.route.trigger("load")},false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete")e.route.trigger("load")})}}})(typeof window!=="undefined"?window.E={}:exports);