(function(n){"use strict";n.controller=function(){var n={};function e(e,r){n[e]=r}e.all=n;return e}();n.control=function(){var e=n.controller.all;function r(n,r,u){t(e[n],r,u);return r}function t(n,e,r){if(!n||u(n,e))return;n._elements.push(e);n(e,r)}function u(n,e){n._elements=n._elements||[];return n._elements.indexOf(e)!==-1}return r}();n.observable=function(n){var e={},r=[].slice;n.on=function(r,t){if(typeof t==="function"){r.replace(/[^\s]+/g,function(n,r){(e[n]=e[n]||[]).push(t);t.typed=r>0})}return n};n.off=function(r,t){if(r==="*")e={};else if(t){var u=e[r];for(var o=0,i;i=u&&u[o];++o){if(i===t)u.splice(o,1)}}else{r.replace(/[^\s]+/g,function(n){e[n]=[]})}return n};n.one=function(e,r){if(r)r.one=true;return n.on(e,r)};n.trigger=function(t){var u=r.call(arguments,1),o=e[t]||[];for(var i=0,c;c=o[i];++i){if(!c.busy){c.busy=true;c.apply(n,c.typed?[t].concat(u):u);if(c.one){o.splice(i,1);i--}c.busy=false}}return n};return n};n.render=function(){var n={},e={"\\":"\\\\","\n":"\\n","\r":"\\r","'":"\\'"},r={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};function t(r,t,o){if(o===true)o=u;r=r||"";return(n[r]=n[r]||new Function("_","e","return '"+r.replace(/[\\\n\r']/g,function(n){return e[n]}).replace(/{\s*([\w\.]+)\s*}/g,"' + (e?e(_.$1,'$1'):_.$1||(_.$1==null?'':_.$1)) + '")+"'"))(t,o)}function u(n,e){return n==null?"":(n+"").replace(/[&\"<>]/g,function(n){return r[n]})}return t}();n.route=function(){var e=[],r;function t(n,e){var r;if(typeof n==="function"){t("*",n)}else if(e){u(n,e)}else if(typeof n==="object"){for(r in n)n.hasOwnProperty(r)&&u(r,n[r])}else o(n);return t}function u(n,r){var t=["match"],u,o;u="^#?!?"+n.replace(/[\/\=\?\$\^]/g,"\\$&").replace(/\*/g,".*").replace(/\{(\w+)\}/g,function(n,e){t.push(e);return"(\\w+)"})+"$";e.push({regex:new RegExp(u),keys:t,callback:r})}function o(n){var u=e.length,o;if(r===n)return;for(o=0;o<u;o++)i(n,e[o]);r=n;t.trigger("visit",n)}function i(n,e){var r=n.match(e.regex);if(r)e.callback(c(n,e.keys,r))}function c(n,e,r){var t={path:n},u=e.length,o;for(o=0;o<u;o++)t[e[o]]=r[o];return t}t.clear=function(){e=[];t.trigger("clear");return t};t.load=function(){t.trigger("load");return t};t.map=e;t.current_path=r;return n.observable(t)}()})(typeof window!=="undefined"?window.E={}:exports);