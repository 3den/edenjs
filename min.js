(function(e){"use strict";e.controller=function(){var e={};function r(r,n){e[r]=n}r.all=e;return r}();e.control=function(){var r=e.controller.all;function n(e,n,i){t(r[e],n,i);return n}function t(e,r,n){if(!e||i(e,r))return;e._elements.push(r);e(r,n)}function i(e,r){e._elements=e._elements||[];return e._elements.indexOf(r)!==-1}return n}();e.observable=function(e){var r={},n=[].slice;e.on=function(n,t){if(typeof t==="function"){n.replace(/\S+/g,function(e,n){(r[e]=r[e]||[]).push(t);t.typed=n>0})}return e};e.off=function(n,t){if(!n||n==="*"){r={}}else if(t){var i=r[n];for(var u=0,o;o=i&&i[u];++u){if(o===t)i.splice(u,1)}}else{n.replace(/\S+/g,function(e){r[e]=[]})}return e};e.one=function(r,n){if(n)n.one=true;return e.on(r,n)};e.trigger=function(t){var i=n.call(arguments,1),u=r[t]||[];for(var o=0,c;c=u[o];++o){if(!c.busy){c.busy=true;c.apply(e,c.typed?[t].concat(i):i);if(c.one){u.splice(o,1);o--}c.busy=false}}return e};return e};e.route=function(){var r=[],n;function t(e,r){var n;if(typeof e==="function"){t("*",e)}else if(r){i(e,r)}else if(typeof e==="object"){for(n in e)e.hasOwnProperty(n)&&i(n,e[n])}else u(e);return t}function i(e,n){var t=["path"],i,u;i="^#?!?"+e.replace(/[\/\=\?\$\^]/g,"\\$&").replace(/\*/g,".*").replace(/\{(\w+)\}/g,function(e,r){t.push(r);return"(\\w+)"})+"$";r.push({regex:new RegExp(i),keys:t,callback:n})}function u(e,i){var u=r.length,c;if(n===e)return;for(c=0;c<u;c++)o(e,r[c]);if(i===false)return;n=e;t.trigger("visit",e)}function o(e,r){var n=e.match(r.regex),t=r.callback;if(!n||!t)return;typeof t==="function"?t(c(e,r.keys,n)):u(t,false)}function c(e,r,n){var t={},i=r.length,u;for(u=0;u<i;u++)t[r[u]]=n[u];return t}function f(e){switch(e[0]){case"?":return n.replace(/\?.*/g,"")+e;case"&":return n.replace(/\&.*/g,"")+e;case"#":return n.replace(/\#.*/g,"")+e}}t.clear=function(){r=[];t.trigger("clear");return t};t.load=function(){t.trigger("load");return t};t.update=function(e,r){e=f(e);r===false?t.trigger("visit",e):u(e)};t.map=r;return e.observable(t)}();e.template=function(){var e={};function r(r,t){e[r]=e[r]||n(r);return t?e[r](t):e[r]}function n(e){var r=t(),n=r[0],i=r[1];return new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split(n).join("	").replace(new RegExp("((^|"+i+")[^	]*)'","g"),"$1\r").replace(new RegExp("	=(.*?)"+i,"g"),"',$1,'").split("	").join("');").split(i).join("p.push('").split("\r").join("\\'")+"');}return p.join('');")}function t(){return typeof r.wrapper==="string"?r.wrapper=r.wrapper.replace(/\s+/,"").split("?"):r.wrapper}r.wrapper="<%?%>";return r}()})(typeof window!=="undefined"?window.E={}:exports);