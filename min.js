(function(e){"use strict";e.controller=function(){var e={};function r(r,n){e[r]=n}r.all=e;return r}();e.control=function(){var r=e.controller.all;function n(e,n,i){t(r[e],n,i);return n}function t(e,r,n){if(!e||i(e,r))return;e._elements.push(r);e(r,n)}function i(e,r){e._elements=e._elements||[];return e._elements.indexOf(r)!==-1}return n}();e.Observable=function(){};e.Observable.prototype={on:function(e,r){var n=this._callbacks;if(typeof r==="function"){e.replace(/\S+/g,function(e,t){(n[e]=n[e]||[]).push(r);r.typed=t>0})}return this},off:function(e,r){var n=this;if(!e||e==="*"){n._callbacks={};return this}e.replace(/\S+/g,function(e){var t=n._callbacks[e]||[],i;if(!r)return n._callbacks[e]=[];for(i=0;t[i];++i)if(t[i]===r)t.splice(i,1)});return this},one:function(e,r){if(r)r.one=true;return this.on(e,r)},trigger:function(e){var r=[].slice.call(arguments,1),n=this._callbacks[e]||[];for(var t=0,i;i=n[t];++t){if(!i.busy){i.busy=true;i.apply(this,i.typed?[e].concat(r):r);if(i.one){n.splice(t,1);t--}i.busy=false}}return this}};e.observable=function(r){var n,t;r._callbacks={};r._observable=new e.Observable;for(n in e.Observable.prototype){r[n]=r._observable[n]}return r};e.route=function(){var r=[],n;function t(e,r){var n;if(typeof e==="function"){t("*",e)}else if(typeof r==="function"){i(e,r)}else if(typeof e==="object"){for(n in e)e.hasOwnProperty(n)&&i(n,e[n])}else o(e,r);return t}function i(e,n){var t=["path"],i,o;i="^#?!?"+e.replace(/[\/\=\?\$\^]/g,"\\$&").replace(/\*/g,".*").replace(/\{(\w+)\}/g,function(e,r){t.push(r);return"([\\w\\-]+)"})+"$";r.push({regex:new RegExp(i),keys:t,callback:n})}function o(e,i){var o=r.length,c;if(n===e)return;for(c=0;c<o;c++)a(e,r[c]);if(i!==false)t.trigger("visit",e);n=e}function a(e,r){var n=e.match(r.regex),t=r.callback;if(!n||!t)return;if(typeof t!=="function")return o(t,false);t(c(e,r.keys,n))}function c(e,r,n){var t={},i=r.length,o;for(o=0;o<i;o++)t[r[o]]=n[o];return t}function u(e){switch(e[0]){case"?":return n.replace(/\?.*/g,"")+e;case"&":return n.replace(/\&.*/g,"")+e;case"#":return n.replace(/\#.*/g,"")+e}}t.clear=function(){r=[];t.trigger("clear");return t};t.load=function(){t.trigger("load");return t};t.update=function(e,r){e=u(e);r===false?t.trigger("visit",e):o(e)};t.map=r;return e.observable(t)}();e.template=function(){var e={};function r(r,t){e[r]=e[r]||n(r);return t?e[r](t):e[r]}function n(e){var r=t(),n=r[0],i=r[1];return new Function("obj","var p=[];"+"with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split(n).join("	").replace(new RegExp("((^|"+i+")[^	]*)'","g"),"$1\r").replace(new RegExp("	=(.*?)"+i,"g"),"',$1,'").split("	").join("');").split(i).join("p.push('").split("\r").join("\\'")+"');}return p.join('');")}function t(){return typeof r.wrapper==="string"?r.wrapper=r.wrapper.replace(/\s+/,"").split("?"):r.wrapper}r.wrapper="<%?%>";return r}()})(typeof window!=="undefined"?window.S={}:exports);