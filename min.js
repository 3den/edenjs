(function(e){"use strict";e.controller=function(){var e={};function n(n,r){e[n]=r}n.all=e;return n}();e.control=function(){var n=e.controller.all;function r(e,r,i){t(n[e],r,i);return r}function t(e,n,r){if(!e||i(e,n))return;e._elements.push(n);e(n,r)}function i(e,n){e._elements=e._elements||[];return e._elements.indexOf(n)!==-1}return r}();e.observable=function(e){var n={},r=[].slice;e.on=function(r,t){if(typeof t==="function"){r.replace(/\S+/g,function(e,r){(n[e]=n[e]||[]).push(t);t.typed=r>0})}return e};e.off=function(r,t){if(!r||r==="*"){n={}}else if(t){var i=n[r];for(var u=0,o;o=i&&i[u];++u){if(o===t)i.splice(u,1)}}else{r.replace(/\S+/g,function(e){n[e]=[]})}return e};e.one=function(n,r){if(r)r.one=true;return e.on(n,r)};e.trigger=function(t){var i=r.call(arguments,1),u=n[t]||[];for(var o=0,c;c=u[o];++o){if(!c.busy){c.busy=true;c.apply(e,c.typed?[t].concat(i):i);if(c.one){u.splice(o,1);o--}c.busy=false}}return e};return e};e.route=function(){var n=[],r;function t(e,n){var r;if(typeof e==="function"){t("*",e)}else if(n){i(e,n)}else if(typeof e==="object"){for(r in e)e.hasOwnProperty(r)&&i(r,e[r])}else u(e);return t}function i(e,r){var t=["path"],i,u;i="^#?!?"+e.replace(/[\/\=\?\$\^]/g,"\\$&").replace(/\*/g,".*").replace(/\{(\w+)\}/g,function(e,n){t.push(n);return"(\\w+)"})+"$";n.push({regex:new RegExp(i),keys:t,callback:r})}function u(e,i){var u=n.length,c;if(r===e)return;for(c=0;c<u;c++)o(e,n[c]);if(i===false)return;r=e;t.trigger("visit",e)}function o(e,n){var r=e.match(n.regex),t=n.callback;if(!r||!t)return;typeof t==="function"?t(c(e,n.keys,r)):u(t,false)}function c(e,n,r){var t={},i=n.length,u;for(u=0;u<i;u++)t[n[u]]=r[u];return t}function f(e){switch(e[0]){case"?":return r.replace(/\?.*/g,"")+e;case"&":return r.replace(/\&.*/g,"")+e;case"#":return r.replace(/\#.*/g,"")+e}}t.clear=function(){n=[];t.trigger("clear");return t};t.load=function(){t.trigger("load");return t};t.update=function(e,n){e=f(e);n===false?t.trigger("visit",e):u(e)};t.map=n;return e.observable(t)}();e.template=function(){var e={};function n(n,t){e[n]=e[n]||r(n);return t?e[n](t):e[n]}function r(e){return new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');")}return n}()})(typeof window!=="undefined"?window.E={}:exports);