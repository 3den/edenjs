(function(e){"use strict";e.controller=function(){var e={};function r(r,n){e[r]=n}r.all=e;return r}();e.control=function(){var r=e.controller.all;function n(e,n,i){t(r[e],n,i);return n}function t(e,r,n){if(!e||i(e,r))return;e._elements.push(r);e(r,n)}function i(e,r){e._elements=e._elements||[];return e._elements.indexOf(r)!==-1}return n}();e.Observable=function(){this._callbacks={}};e.Observable.prototype={on:function(e,r){var n=this._callbacks;if(typeof r==="function"){e.replace(/\S+/g,function(e){(n[e]=n[e]||[]).push(r)})}return this},off:function(e,r){var n=this;if(!e||e==="*"){n._callbacks=this._parent?Object.create(this._parent._callbacks):{};return this}e.replace(/\S+/g,function(e){var t,i=n._callbacks[e]||[];if(!r)return n._callbacks[e]=[];for(t=0;i[t];++t)if(i[t]===r)i.splice(t,1)});return this},one:function(e,r){if(r)r.one=true;return this.on(e,r)},trigger:function(e){var r,n,t=[].slice.call(arguments,1),i=this._callbacks[e]||[];for(r=0;n=i[r];++r){if(!n.busy){n.busy=true;n.apply(this,t);if(n.one)i.splice(r--,1);n.busy=false}}return this},create:function(e){e._parent=this;e._callbacks=Object.create(this._callbacks);return r(Object.create(this),e)}};e.observable=function(n){return r(n,new e.Observable)};function r(e,r){for(var n in r)e[n]=r[n];return e}e.route=function(){var r=[],n;function t(e,r){var n;if(typeof e==="function"){t("*",e)}else if(typeof r==="function"){i(e,r)}else if(typeof e==="object"){for(n in e)e.hasOwnProperty(n)&&i(n,e[n])}else c(e,r);return t}function i(e,n){var t=["path"],i,c;i="^#?!?"+e.replace(/[\/\=\?\$\^]/g,"\\$&").replace(/\*/g,".*").replace(/\{(\w+)\}/g,function(e,r){t.push(r);return"([\\w\\-]+)"})+"$";r.push({regex:new RegExp(i),keys:t,callback:n})}function c(e,i){var c=r.length,u;if(n===e)return;for(u=0;u<c;u++)a(e,r[u]);if(i!==false)t.trigger("visit",e);n=e}function a(e,r){var n=e.match(r.regex),t=r.callback;if(!n||!t)return;if(typeof t!=="function")return c(t,false);t(u(e,r.keys,n))}function u(e,r,n){var t={},i=r.length,c;for(c=0;c<i;c++)t[r[c]]=n[c];return t}function o(e){switch(e[0]){case"?":return n.replace(/\?.*/g,"")+e;case"&":return n.replace(/\&.*/g,"")+e;case"#":return n.replace(/\#.*/g,"")+e}}t.clear=function(){r=[];t.trigger("clear");return t};t.load=function(){t.trigger("load");return t};t.update=function(e,r){e=o(e);r===false?t.trigger("visit",e):c(e)};t.map=r;return e.observable(t)}();e.template=function(){var e={};function r(r,t){e[r]=e[r]||n(r);return t?e[r](t):e[r]}function n(e){var r=t(),n=r[0],i=r[1];return new Function("obj","var p=[];"+"with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split(n).join("	").replace(new RegExp("((^|"+i+")[^	]*)'","g"),"$1\r").replace(new RegExp("	=(.*?)"+i,"g"),"',$1,'").split("	").join("');").split(i).join("p.push('").split("\r").join("\\'")+"');}return p.join('');")}function t(){return typeof r.wrapper==="string"?r.wrapper=r.wrapper.replace(/\s+/,"").split("?"):r.wrapper}r.wrapper="<%?%>";return r}()})(typeof window!=="undefined"?window.S={}:exports);